#!/usr/bin/make -f
# -*- makefile -*-
# Sample debian/rules that uses debhelper.
# This file was originally written by Joey Hess and Craig Small.
# As a special exception, when this file is copied by dh-make into a
# dh-make output file, you may use that output file without restriction.
# This special exception was added by Craig Small in version 0.37 of dh-make.

# Uncomment this to turn on verbose mode.
#export DH_VERBOSE=1

PLUGIN = foreman_remote_execution
PLUGIN_HAS_ASSETS = true
PLUGIN_HAS_WEBPACK = true
PLUGIN_HAS_PACKAGE_JSON = true

include /usr/share/foreman/foreman-plugin.mk

override_dh_auto_install:
	mv ./usr/share/foreman/vendor/ruby/*/gems/foreman_remote_execution-*/extra ./
	# cockpit-ws ships /usr/lib/cockpit/cockpit-ws on Debian, not /usr/libexec/cockpit-ws
	sed -i 's#libexec#lib/cockpit#' ./extra/cockpit/foreman-cockpit.service
	mv ./extra/cockpit/cockpit.conf.example ./extra/cockpit/cockpit.conf
	mv ./extra/cockpit/settings.yml.example ./extra/cockpit/foreman-cockpit-session.yml
	dh_auto_install
